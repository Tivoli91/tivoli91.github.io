<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Windows PowerShell进阶(31) 理解Module"><meta name="keywords" content="进阶,Module"><meta name="author" content="超速蜗牛,undefined"><meta name="copyright" content="超速蜗牛"><title>Windows PowerShell进阶(31) 理解Module【超速蜗牛的博客】</title><link rel="stylesheet" href="/css/fan.css"><link rel="stylesheet" href="/css/thirdparty/jquery.mCustomScrollbar.min.css"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch-theme-algolia.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4"></script><!-- link(rel="dns-prefetch" href="https://cdn.jsdelivr.net")--><!-- link(rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css")--><!-- script(src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer)--><!-- script(src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML")--><script src="/js/mathjax/mathjax.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
});
</script><script>var isPassword = '' || false;
if (isPassword) {
    if (prompt('请输入文章密码') !== '') {
        alert('密码错误！');
        history.back();
    }
}</script><script>window.GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"AOHMI93W80","apiKey":"3f74c7e8113768c69c3eedfd6540618f","indexName":"hexo","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
}</script></head><body><canvas id="universe"></canvas><!--#body--><div id="sidebar"><div class="toggle-sidebar-info button-hover"><span data-toggle="文章目录">站点概览</span></div><div class="sidebar-toc"><div class="sidebar-toc-title">目录</div><div class="sidebar-toc-progress"><span class="progress-notice">您已阅读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc-progress-bar"></div></div><div class="sidebar-toc-content" id="sidebar-toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#概述"><span class="toc-number">1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模块组件和类型-Module-Components-and-Types"><span class="toc-number">2.</span> <span class="toc-text">模块组件和类型(Module Components and Types)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#脚本模块-Script-Modules"><span class="toc-number">2.1.</span> <span class="toc-text">脚本模块(Script Modules)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#二进制模块-Binary-Modules"><span class="toc-number">2.2.</span> <span class="toc-text">二进制模块(Binary Modules)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#清单模块-Manifest-Modules"><span class="toc-number">2.3.</span> <span class="toc-text">清单模块(Manifest Modules)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#动态模块-Dynamic-Modules"><span class="toc-number">2.4.</span> <span class="toc-text">动态模块(Dynamic Modules)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模块清单-Module-Manifests"><span class="toc-number">3.</span> <span class="toc-text">模块清单(Module Manifests)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#保存和安装模块-Storing-and-Installing-a-Module"><span class="toc-number">4.</span> <span class="toc-text">保存和安装模块(Storing and Installing a Module)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模块命令集和变量-Module-Cmdlets-and-Variables"><span class="toc-number">5.</span> <span class="toc-text">模块命令集和变量(Module Cmdlets and Variables)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#编者总结"><span class="toc-number">6.</span> <span class="toc-text">编者总结</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info-avatar"><img class="author-info-avatar-img" src="/avatar.png"></div><div class="author-info-name">超速蜗牛</div><div class="author-info-description">Learn PowerShell.</div><div class="links-buttons"><a class="links-button button-hover" href="https://gitee.com/chaoyuew" target="_blank">Gitee<i class="icon-dot bg-color1"></i></a><a class="links-button button-hover" href="mailto:348001390@qq.com" target="_blank">E-Mail<i class="icon-dot bg-color3"></i></a><a class="links-button button-hover" href="tencent://message/?uin=348001390&amp;Site=&amp;Menu=yes" target="_blank">QQ<i class="icon-dot bg-color4"></i></a></div><div class="author-info-articles"><a class="author-info-articles-archives article-meta" href="/archives"><span class="pull-top">日志</span><span class="pull-bottom">35</span></a><a class="author-info-articles-tags article-meta" href="/tags"><span class="pull-top">标签</span><span class="pull-bottom">44</span></a><a class="author-info-articles-categories article-meta" href="/categories"><span class="pull-top">分类</span><span class="pull-bottom">2</span></a></div></div></div><div id="main-container"><header><div id="menu-outer"><i class="menu-list-icon fas fa-bars"></i><nav id="menu-inner"><a class="menu-item" href="/">首页</a><a class="menu-item" href="/tags">标签</a><a class="menu-item" href="/categories">分类</a><a class="menu-item" href="/archives">归档</a><a class="menu-item" href="/about">关于</a></nav><div class="right-info"><a class="search social-icon"><i class="fas fa-search"></i><span> 搜索</span></a><a class="title-name" href="/">超速蜗牛的博客</a><span id="now-time"></span></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><div class="post-header"><div class="title">Windows PowerShell进阶(31) 理解Module</div><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 发表于 2019-09-03 | 更新于 2019-09-03</time><!--time.button-hover.post-date #[i.fas.fa-calendar-alt.article-icon(aria-hidden="true")] #[=__('post.modified')] #[=date(page['updated'], config.date_format)]--><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/powershell/">powershell</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/进阶/">进阶</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/Module/">Module</a></div></div></div><div class="main-content"><p>本文首发于本人公众号SPPS178,现搬运过来,较原文有所改动.</p>
<p>上篇我们在操作excel文件的时候用到了别人写好的module，我们在Windows PowerShell入门（19）脚本讲脚本和profile的时候有提到过powershell module， 今天我们专门讲下powershell module的知识点。主要参考微软官方文档，以下为翻译。</p>
<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>一个<code>模块(module)</code>是一组相关的Windows PowerShell功能，作为一个便捷单元组合在一起（通常保存在一个目录中）。 通过将一组相关的脚本文件，程序集和相关资源定义为模块，您可以比其他方式更容易地引用，加载，保留和共享代码。</p>
<p><code>模块的主要目的是允许Windows PowerShell代码的模块化（即重用和抽象）</code>。 例如，创建模块的最基本方法是将Windows PowerShell脚本简单地保存为.psm1文件。 <code>这样做可以让您控制（即公开或私有）脚本中包含的函数和变量</code>。 将该脚本另存为.psm1文件还允许您控制某些变量的范围。 最后，您还可以使用诸如Install-Module之类的cmdlet来组织，安装和使用脚本作为更大型解决方案的构建块。</p>
<a id="more"></a>

<p>（编者：其实就是和java/python 中的import xxx； C#中的using XXX类似，可以当扩展插件理解）</p>
<h3 id="模块组件和类型-Module-Components-and-Types"><a href="#模块组件和类型-Module-Components-and-Types" class="headerlink" title="模块组件和类型(Module Components and Types)"></a>模块组件和类型(Module Components and Types)</h3><p>一个模块由四个基本组件组成：</p>
<ol>
<li>某种代码文件 - 通常是PowerShell脚本或托管cmdlets程序集。</li>
<li>上述代码文件可能需要的其他内容，例如其他程序集，帮助文件或脚本。</li>
<li>描述上述文件的清单文件，以及存储作者和版本信息等元数据。</li>
<li>一个包含所有上述内容的目录，位于PowerShell可以合理找到它的位置。</li>
</ol>
<p>请注意，这些组件本身都不是实际必需的。 例如，一个模块在技术上可以只是一个存储在.psm1文件中的脚本。 你也可以有一个模块，只是一个清单文件，主要用于组织目的。 您也可以编写一个动态创建模块的脚本，因此实际上并不需要用于存储任何内容的目录。以下各节通过混合并匹配模块的不同可能部分来描述可以获取的模块类型。</p>
<h4 id="脚本模块-Script-Modules"><a href="#脚本模块-Script-Modules" class="headerlink" title="脚本模块(Script Modules)"></a>脚本模块(Script Modules)</h4><p>顾名思义，脚本模块是一个包含任何有效的Windows PowerShell代码的文件（.psm1）。脚本开发人员和管理员可以使用这种类型的模块来创建模块，其成员包括函数，变量等。<code>从本质上讲，脚本模块只是一个具有不同扩展名的Windows PowerShell脚本，允许管理员在其上使用导入，导出和管理功能。</code></p>
<p>另外，您可以使用清单文件在模块中包含其他资源，例如数据文件，其他依赖模块或运行时脚本。清单文件对于跟踪元数据（如创作和版本信息）也很有用。</p>
<p>最后，脚本模块与其他未动态创建的模块一样，需要保存在PowerShell可合理发现的文件夹中。通常，这是在PowerShell模块路径上;但如果有必要，您可以明确描述您的模块安装位置。有关更多信息，请参阅如何编写PowerShell脚本模块（文末有链接）。（图片是我自己弄得，不是原文带有的）</p>
<center><img style="border-radius: 0.3125em;box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="http://ww1.sinaimg.cn/large/007tGxtGgy1g6mpl9n2h3j30j80cnq3l.jpg"><br><div>31-1 success-load-script-module</div></center>


<h4 id="二进制模块-Binary-Modules"><a href="#二进制模块-Binary-Modules" class="headerlink" title="二进制模块(Binary Modules)"></a>二进制模块(Binary Modules)</h4><p>二进制模块是包含已编译代码（如C#）的.NET Framework程序集（.dll）。 Cmdlet开发人员可以使用此类模块共享cmdlet，提供程序等。 （现有管理单元也可以用作二进制模块。）与脚本模块相比，二进制模块允许您创建速度更快的cmdlet或使用功能（如多线程），这些功能在Windows PowerShell脚本中不易编码。</p>
<p>和脚本模块一样，您可以包含一个清单文件来描述您的模块使用的其他资源，并跟踪有关您的模块的元数据。 同样，您可能应该将您的二进制模块安装在PowerShell模块路径某处的某个文件夹中。 有关更多信息，请参阅如何编写PowerShell二进制模块（文末有链接）。</p>
<p>（编者：以下代码和图片是我自己弄得，非原文所有）</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line"></span><br><span class="line">namespace ModuleCmdlets</span><br><span class="line">&#123;</span><br><span class="line">    public class TestBinaryModule</span><br><span class="line">    &#123;</span><br><span class="line">        public static String <span class="keyword">Begin</span>()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"This is from DLL module"</span>; <span class="comment"># this will be printed in screen</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们把上面的C#代码编译成DLL（具体怎么编译，大家课外了解下）</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd C:\Windows\Microsoft.NET\Framework\v4.<span class="number">0.30319</span></span><br><span class="line">csc /t:library /out:D\test.dll D\Test-BinaryModule.cs</span><br></pre></td></tr></table></figure>

<p>然后我们把这个DLL重命名放在指定powershell module 目录下，重开powershell，试着运行。</p>
<center><img style="border-radius: 0.3125em;box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="http://ww1.sinaimg.cn/large/007tGxtGgy1g6mpllgzmrj30p709aaas.jpg"><br><div>31-2 success-load-binary-module</div></center>

<h4 id="清单模块-Manifest-Modules"><a href="#清单模块-Manifest-Modules" class="headerlink" title="清单模块(Manifest Modules)"></a>清单模块(Manifest Modules)</h4><p>清单模块是一个使用清单文件来描述其所有组件的模块，但是没有任何核心程序集或脚本。 （正式情况下，清单模块将清单的ModuleToProcess或RootModule元素留空。）但是，仍然可以使用模块的其他功能，例如加载相关程序集或自动运行某些预处理脚本的功能。 您还可以使用清单模块作为便捷方式来打包其他模块将使用的资源，例如嵌套的模块，程序集，类型或格式。 有关更多信息，请参阅如何编写PowerShell模块清单。（文末有链接）。</p>
<h4 id="动态模块-Dynamic-Modules"><a href="#动态模块-Dynamic-Modules" class="headerlink" title="动态模块(Dynamic Modules)"></a>动态模块(Dynamic Modules)</h4><p>动态模块是不从模块加载或保存到文件的模块。 相反，它们是由脚本使用New-Module cmdlet动态创建的。 这种类型的模块使脚本能够按需创建模块，而无需将其加载或保存到永久存储器中。 就其性质而言，动态模块的寿命较短，因此无法通过<code>Get-Module</code> cmdlets访问。 同样，他们通常不需要模块清单，也不需要永久文件夹来存储相关的程序集。</p>
<h3 id="模块清单-Module-Manifests"><a href="#模块清单-Module-Manifests" class="headerlink" title="模块清单(Module Manifests)"></a>模块清单(Module Manifests)</h3><p>模块清单是一个包含散列表的.psd1文件。 哈希表中的键和值执行以下操作：</p>
<ul>
<li>描述模块的内容和属性。</li>
<li>定义先决条件。</li>
<li>确定组件的处理方式。</li>
</ul>
<p>清单对于模块不是必须的。 模块可以引用脚本文件（.ps1），脚本模块文件（.psm1），清单文件（.psd1），格式和类型文件（.ps1xml），cmdlet和提供程序集（.dll），资源文件，帮助文件，本地化 文件或捆绑在模块中的任何其他类型的文件或资源。 对于国际化脚本，模块文件夹还包含一组消息目录文件。 如果将清单文件添加到模块文件夹中，则可以通过引用清单来将多个文件作为单个单元引用。</p>
<p>清单本身描述了以下几类信息：</p>
<ul>
<li>关于模块的元数据，例如模块版本号，作者和描述。</li>
<li>导入模块所需的先决条件，例如Windows PowerShell版本，公共语言运行库（CLR）版本和所需的模块。</li>
<li>处理指令，例如要处理的脚本，格式和类型。</li>
<li>限制要导出的模块成员，例如要导出的别名，函数，变量和cmdlet。</li>
</ul>
<p>有关更多信息，请参阅如何编写PowerShell模块清单。</p>
<h3 id="保存和安装模块-Storing-and-Installing-a-Module"><a href="#保存和安装模块-Storing-and-Installing-a-Module" class="headerlink" title="保存和安装模块(Storing and Installing a Module)"></a>保存和安装模块(Storing and Installing a Module)</h3><p>一旦创建了脚本，二进制或清单模块，就可以将工作保存在其他人可以访问的位置。 例如，您的模块可以存储在安装Windows PowerShell的系统文件夹中，也可以存储在用户文件夹中。</p>
<p>一般来说，您可以通过使用存储在<code>$ENV:PSModulePath</code>变量中的路径之一来确定应安装模块的位置。 使用这些路径之一意味着当用户在其代码中调用它时，PowerShell可以<strong>自动查找并加载您的模块</strong>。 如果您将模块存储在其他位置，则在调用<code>Install-Module</code>时，可以通过将模块位置作为参数传递给PowerShell(如下)。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Import-Module</span> C:\Users\SPPS\Test-BinaryModule</span><br></pre></td></tr></table></figure>

<p>无论如何，文件夹的路径称为模块的基础（ModuleBase），脚本，二进制或清单模块文件的名称应与模块文件夹名称相同，但以下情况除外：</p>
<ul>
<li>由<code>New-Module</code> cmdlet创建的动态模块可以使用cmdlet的Name参数命名。</li>
<li>通过<code>Import-Module</code> -Assembly命令从汇编对象导入的模块根据以下语法命名：“dynamic_code_module_”+ assembly.GetName（）。</li>
</ul>
<h3 id="模块命令集和变量-Module-Cmdlets-and-Variables"><a href="#模块命令集和变量-Module-Cmdlets-and-Variables" class="headerlink" title="模块命令集和变量(Module Cmdlets and Variables)"></a>模块命令集和变量(Module Cmdlets and Variables)</h3><p>Windows PowerShell提供了以下cmdlets和变量，用于创建和管理模块。</p>
<ul>
<li><code>New-Module</code> cmdlet<br>此cmdlet创建仅存在于内存中的新动态模块。 该模块是从脚本块创建的，并且其导出的成员（例如其函数和变量）在会话中立即可用并保持可用，直到会话关闭。</li>
<li><code>New-ModuleManifest</code> cmdlet<br>此cmdlet创建一个新的模块清单（.psd1）文件，填充其值，并将清单文件保存到指定的路径。此cmdlet也可用于创建可手动填写的模块清单模板。</li>
<li><code>Import-Module</code> cmdlet<br>此cmdlet将一个或多个模块添加到当前会话。</li>
<li><code>Get-Module</code> cmdlet<br>此cmdlet检索有关已经或可以导入当前会话的模块的信息。</li>
<li><code>Export-ModuleMecm</code> cmdlet<br>此cmdlet指定从脚本模块（.psm1）文件或通过使用New-Module cmdlet创建的动态模块导出的模块成员（如cmdlet，函数，变量和别名）。</li>
<li><code>Remove-Module</code> cmdlet<br>此cmdlet从当前会话中删除模块。</li>
<li><code>Test-ModuleManifest</code> cmdlet<br>此cmdlet通过验证模块清单文件（.psd1）中列出的文件实际存在于指定路径中来验证模块清单是否准确地描述了模块的组件。</li>
<li><code>$PSScriptRoot</code><br>该变量包含正在执行脚本模块的目录。它使脚本能够使用模块路径访问其他资源。</li>
<li><code>$ENV:PSModulePath</code><br>此环境变量包含存储Windows PowerShell模块的目录列表。自动导入模块并更新模块的帮助主题时，Windows PowerShell将使用此变量的值。</li>
</ul>
<h3 id="编者总结"><a href="#编者总结" class="headerlink" title="编者总结"></a>编者总结</h3><p>不知道大家看下来有没有什么想法，反正我自己是有一个疑问：Module和Profile有什么区别？</p>
<p>我们在<a href="https://chaoyuew.gitee.io/WPS-19-Basic-Script.html">Windows PowerShell入门(19) 脚本</a>介绍过powershell的profile文件，其也可以在powershell运行时自动加载profile里面定义好的无论函数还是变量。如下所示，我们将之前的module文件夹暂时移除，然后将module里面的函数写到profile.ps1里面，然后重新打开powershell。</p>
<center><img style="border-radius: 0.3125em;box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="http://ww1.sinaimg.cn/large/007tGxtGgy1g6mpm3wattj30rp0erwfd.jpg"><br><div>31-3 load-same-function-from-profile</div></center>

<p>可以看到效果是一样的，那么我们为什么还要用module呢？后来在看官网文档和写这篇文章的时候多少有点体会了，抬杠一点说是的，你代码写在module还是profile里面都能够成功运行。但是<code>Module的主要目的是为了代码的模块化以及其内部控制的私有化/公有化</code>。</p>
<ul>
<li>模块化<br>这意味着代码更加容易维护和迁移，如果所有功能都写在一个profile里面，那么出错的时候不好debug。而且当你给别人用特定功能的时候，module可以直接copy对应的module文件夹给别人，但是profile因为里面还有别的功能的函数，直接给别人用的话，显然不是我们想要的结果。单独挑出来特定函数又费力不讨好，还容易遗漏出错。大家可以看下上篇我们用的importexcel的module有多少个文件和函数。 现在还觉得把这些功能都写在profile里面可行吗？</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">7550</span> AddConditionalFormatting.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">3122</span> Charting.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">4148</span> ColorCompletion.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM          <span class="number">19345</span> Compare-Worksheet.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">4060</span> ConvertExcelToImageFile.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">1377</span> ConvertFromExcelData.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">6401</span> ConvertFromExcelToSQLInsert.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">1634</span> ConvertToExcelXlsx.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM            <span class="number">728</span> Copy-ExcelWorkSheet.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM        <span class="number">1068032</span> EPPlus.dll</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">2681</span> Export-Charts.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM          <span class="number">48501</span> Export-Excel.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">1190</span> Export-ExcelSheet.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM          <span class="number">13190</span> formatting.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM            <span class="number">546</span> Get-ExcelColumnName.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">1443</span> Get-ExcelSheetInfo.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">2425</span> Get-ExcelWorkbookInfo.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">1232</span> Get-HtmlTable.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM            <span class="number">109</span> Get-Range.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM            <span class="number">779</span> Get-XYRange.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM            <span class="number">576</span> Import-Html.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">4173</span> ImportExcel.psd1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM          <span class="number">23428</span> ImportExcel.psm1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">1964</span> InferData.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM            <span class="number">861</span> Invoke-Sum.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">1962</span> New-ConditionalFormattingIconSet.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">1332</span> New-ConditionalText.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">1027</span> New-ExcelChart.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM            <span class="number">433</span> New-PSItem.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">1962</span> Open-ExcelPackage.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM            <span class="number">567</span> Pivot.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">6049</span> Plot.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">7741</span> Send-SQLDataToExcel.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM            <span class="number">353</span> Set-CellStyle.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">9068</span> Set-Column.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">8564</span> Set-Row.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">9373</span> SetFormat.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM            <span class="number">526</span> TrackingUtils.ps1</span><br><span class="line">-a----        <span class="number">6</span>/<span class="number">15</span>/<span class="number">2018</span>   <span class="number">2</span>:<span class="number">15</span> PM           <span class="number">3256</span> Update-FirstObjectProperties.ps1</span><br></pre></td></tr></table></figure>

<ul>
<li>控制（即公开或私有）脚本中包含的函数和变量<br>下面这张图片足以说明(点击查看大图)</li>
</ul>
<center><img style="border-radius: 0.3125em;box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="http://ww1.sinaimg.cn/large/007tGxtGgy1g6mpn21752j30pa0oa765.jpg"><br><div>31-4 control-module</div></center>

<blockquote>
<p>参考链接<br><a href="https://msdn.microsoft.com/en-us/library/dd878324(v=vs.85).aspx" target="_blank" rel="noopener">综述</a><br><a href="https://msdn.microsoft.com/en-us/library/dd878340(v=vs.85).aspx" target="_blank" rel="noopener">如何编写脚本模块</a><br><a href="https://msdn.microsoft.com/en-us/library/dd878342(v=vs.85).aspx" target="_blank" rel="noopener">如何编写二进制模块</a><br><a href="https://msdn.microsoft.com/en-us/library/dd878337(v=vs.85).aspx" target="_blank" rel="noopener">如何编写模块清单</a><br><a href="https://msdn.microsoft.com/en-us/library/dd878343(v=vs.85).aspx" target="_blank" rel="noopener">编写模块帮助信息</a></p>
</blockquote>
<p>今天稍微讲了下Module的知识，但是我知道肯定说的不够全面，大家有时间还是要多看看微软的官方文档，多敲敲代码加深理解。</p>
<p>相关代码等文件已上传 <a href="https://gitee.com/chaoyuew/powershell/tree/feature/wechat/SPPS31" target="_blank" rel="noopener">https://gitee.com/chaoyuew/powershell/tree/feature/wechat/SPPS31</a></p>
<center><img style="border-radius: 0.3125em;box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="http://ww1.sinaimg.cn/large/007tGxtGgy1g6mpni2t9aj31hc0u04kc.jpg"><br><div></div></center>
</div><div class="post-copyright"><div class="post-copyright-author"><span class="post-copyright-meta">本文作者: </span><span class="post-copyright-info"><a href="mailto:undefined">超速蜗牛</a></span></div><div class="post-copyright-type"><span class="post-copyright-meta">本文链接: </span><span class="post-copyright-info"><a href="https://chaoyuew.gitee.io/WPS-31-Advanced-Understanding-Module.html">https://chaoyuew.gitee.io/WPS-31-Advanced-Understanding-Module.html</a></span></div><div class="post-copyright-notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://chaoyuew.gitee.io">超速蜗牛的博客</a>！</span></div></div></article><div id="pagination"><div class="prev-post pull-left"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/WPS-32-Advanced-Auto-Upload-Bulk-Image-To-QiNiuYun.html"><i class="fas fa-angle-left">&nbsp;</i><span>Windows PowerShell进阶(32) 七牛云批量自动上传图片</span></a></div><div class="next-post pull-right"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/WPS-30-Advanced-Manage-Excel-File-Without-Excel-Installed.html"><span>Windows PowerShell进阶(30) 未安装Excel情况下操作Excel文件</span><span>&nbsp;</span><i class="fas fa-angle-right"></i></a></div></div><!--div!= paginator()--></div></div><div class="button-hover" id="return-top"><i class="fas fa-arrow-up" aria-hidden="true"></i></div><footer><div id="footer"><div class="button-hover" id="side-button"><i class="fas fa-arrow-right"></i></div><div class="right-content"><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fas fa-file-o"></i></span><span id="busuanzi_value_page_pv"></span><span></span></div><div class="copyright">&copy;2019 By 超速蜗牛</div></div></div></footer></div><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery-3.3.1.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/velocity.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery.mCustomScrollbar.concat.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/fan.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/canvas_bg.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/utils.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/scroll.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/sidebar.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/copy.js"></script><!--script(src=url)--><div class="search-dialog"><div id="algolia-search-title">Algolia</div><div class="search-close-button"><i class="fa fa-times"></i></div><!--div#current-refined-values--><!--div#clear-all--><div id="search-box"></div><!--div#refinement-list--><hr><div id="hits"></div><div id="algolia-pagination"></div></div><div class="search-mask"></div><script src="/js/search/algolia.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>